<!DOCTYPE html>
<html  xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
    <title>Insert title here</title>
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}" />
</head>
<body>
   <div >
      
      <table  id="listtable"  border=2  width="100%" >
          <tr>
             <th>姓名</th>
             <th>作品名称</th>
             <th>性别</th>
             <th>邮箱</th>
             <th>学号</th>          
             <th>学院</th>        
             <th>班级</th>
             <th>手机</th>
             <th>qq</th>
             <th>微信</th>
             <th>操作</th>
           </tr> 
           <tr th:each="contestant : ${conlist}">
             <td th:text="${contestant.name}"></td>
           
             <td th:text="${contestant.sex}"></td>
             <td th:text="${contestant.email}"></td>
             <td th:text="${contestant.num}"></td>
             <td th:text="${contestant.academy}"></td>
             <td th:text="${contestant.classname}"></td>
             <td th:text="${contestant.phone}"></td>
             <td th:text="${contestant.qq}"></td>
             <td th:text="${contestant.wechat}"></td>
             <td >
                <input type="button"   th:onclick="'updatecon(\''+${contestant.id}+'\')' "  value="修改"/>
                <input type="button" th:onclick="'delcon(\''+${contestant.id}+'\')' "  value="删除"/>
             </td>
           </tr>
            <tr>
             <td><a  href="contestant">添加</a></td>
           </tr> 
      </table>
   </div>
   <!--修改弹框-->
<div class="modal fade" id="addcon" tabindex="-1" role="dialog" aria-labelledby="addroleLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="addroleLabel">修改信息</h4>
            </div>
            <div class="modal-body">
                <form id="contForm">
                    <input type="hidden" id="id" class="id" name="id">
                    <div class="form-group">
                        <label class="control-label">姓名:</label>
                        <input type="text" class="form-control" name="name" id="name" placeholder="请输入姓名"/>
                    </div>
                    <div class="form-group">
                        <label class="control-label">性别:</label>
                        <input type="text" class="form-control" name="sex" id="sex" placeholder="请输入性别"/>
                    </div>
                    <div class="form-group">
                        <label class="control-label">邮箱:</label>
                        <input type="text" class="form-control" name="email" id="email" placeholder="请输入邮箱"/>
                    </div>
                    <div class="form-group">
                        <label class="control-label">学号:</label>
                        <input type="text" class="form-control" name="num" id="num" placeholder="请输入学号"/>
                    </div>
                    <div class="form-group">
                        <label class="control-label">学院:</label>
                        <input type="text" class="form-control" name="academy" id="academy" placeholder="请输入学院"/>
                    </div>
                    <div class="form-group">
                        <label class="control-label">班级:</label>
                        <input type="text" class="form-control" name="classname" id="classname" placeholder="请输入班级"/>
                    </div>
                    <div class="form-group">
                        <label class="control-label">手机:</label>
                        <input type="text" class="form-control" name="phone" id="phone" placeholder="请输入手机"/>
                    </div>
                    <div class="form-group">
                        <label class="control-label">qq:</label>
                        <input type="text" class="form-control" name="qq" id="qq" placeholder="请输入qq"/>
                    </div>
                    <div class="form-group">
                        <label class="control-label">wechat:</label>
                        <input type="text" class="form-control" name="wechat" id="wechat" placeholder="请输入微信"/>
                    </div>
                </form>
            </div>
   
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" onclick="addcon();" class="btn btn-primary">保存</button>
            </div>
        </div>
    </div>
</div>

   <!--end-Footer-part-->
	<script type="text/javascript" th:src="@{/js/jquery-1.11.2.min.js}"></script>
	<script th:src="@{/js/bootstrap.min.js}"></script>
	<script th:src="@{/js/jquery.dataTables.min.js}"></script>
	<script th:src="@{/js/layer.js}"></script>
	<script type="text/javascript" th:src="@{/js/jquery.ztree.core.js}"></script>
	<script type="text/javascript" th:src="@{/js/jquery.ztree.excheck.js}"></script>
   <script>
	   ///////////////////////////////
       //更新信息
       function addcon(){
    	   $.ajax({
    		   async:false,
               type: "post",
               url:'/cont/updatecon',
               data:$('#contForm').serialize(),// 你的formid
               success: function(data) {
                   if(data=="Ok"){
                       layer.msg('修改成功');
                       window.location.reload();
                       $('#addcon').modal('hide');
                   }else{
                       layer.msg('修改失败');
                       $('#addcon').modal('hide');
                   }
               }
           });
       }
    
       //去更新页面
       function updatecon(id){
    	    $.ajax({
                async:false,
                type : "get",
                data:{id:id},
                url: "/cont/getonecon",
                dataType:'json',
                success: function(data){
                    $("#id").val(data.id);
                    $("#name").val(data.name);
                    $("#sex").val(data.sex);
                    $("#email").val(data.email);
                    $("#num").val(data.num);
                    $("#academy").val(data.academy);
                    $("#classname").val(data.classname);
                    $("#phone").val(data.phone);
                    $("#qq").val(data.qq);
                    $("#wechat").val(data.wechat);
                	$('#addcon').modal();
                }
            });
       }
       //删除
       function delcon(id){
    	   layer.confirm('您确定要删除信息吗？', {
               btn: ['确认','取消'] //按钮
           }, function(){
               $.ajax({
                   cache: true,
                   type: "POST",
                   url:'/cont/del',
                   data:{id:id},
                   async: false,
                   success: function(data) {
                       if(data=="Ok"){
                           layer.msg('删除成功');
                           window.location.reload();
                       }else{
                           layer.msg('删除失败');
                       }
                   }
               });
           });
       }
   </script>
</body>
</html>